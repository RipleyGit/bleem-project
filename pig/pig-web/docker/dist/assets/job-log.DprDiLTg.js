import{u as R}from"./table.DpIaW019.js";import{s as I,v as A,k as J,d as L}from"./index.Cli_Cq8U.js";import{u as O}from"./dict.BLN-_P-8.js";import{a as P,r as d,y as W,ae as r,af as T,o as c,E as p,H as i,e as k,G as l,Q as m,u as e,U as w,V as j,x as D,K as X}from"./vue.DKOcwzik.js";import"./dict.DbD4nPEQ.js";function Y(_){return I({url:"/job/sys-job-log/page",method:"get",params:_})}const Z={class:"layout-padding-auto layout-padding-view"},ee={class:"mb8",style:{width:"100%"}},le=P({name:"job-log",setup(_,{expose:V}){const{t}=A.useI18n(),g=d(!1),{job_execute_status:$}=O("job_type","job_execute_status"),z=d(),b=d(!0),v=d([]),x=d(!0),u=W({queryForm:{jobId:""},pageList:Y,createdIsNeed:!1}),{getDataList:h,currentChangeHandle:B,sizeChangeHandle:H,tableStyle:C}=R(u),N=a=>{v.value=a.map(({jobLogId:o})=>o),x.value=!a.length},S=async a=>{try{await J().confirm(t("common.delConfirmText"))}catch{return}try{await function(o){return I({url:"/job/sys-job-log",method:"delete",data:o})}(a),h(),L().success(t("common.delSuccessText"))}catch(o){L().error(o.msg)}};return V({openDialog:a=>{g.value=!0,u.queryForm.jobId=a,h()}}),(a,o)=>{const y=r("el-button"),Q=r("right-toolbar"),U=r("el-row"),n=r("el-table-column"),q=r("dict-tag"),F=r("el-table"),M=r("pagination"),E=r("el-dialog"),f=T("auth"),G=T("loading");return c(),p(E,{modelValue:e(g),"onUpdate:modelValue":o[2]||(o[2]=s=>D(g)?g.value=s:null),"close-on-click-modal":!1,fullscreen:"",title:"\u8FD0\u884C\u65E5\u5FD7",draggable:""},{default:i(()=>[k("div",Z,[l(U,null,{default:i(()=>[k("div",ee,[m((c(),p(y,{formDialogRef:"",disabled:e(x),icon:"Delete",type:"primary",class:"ml10",onClick:o[0]||(o[0]=s=>S(e(v)))},{default:i(()=>[w(j(a.$t("common.delBtn")),1)]),_:1},8,["disabled"])),[[f,"sys_log_del"]]),l(Q,{showSearch:e(b),"onUpdate:showSearch":o[1]||(o[1]=s=>D(b)?b.value=s:null),class:"ml10",style:{float:"right","margin-right":"20px"},onQueryTable:e(h)},null,8,["showSearch","onQueryTable"])])]),_:1}),m((c(),p(F,{data:e(u).dataList,style:{width:"100%"},onSelectionChange:N,border:"","cell-style":e(C).cellStyle,"header-cell-style":e(C).headerCellStyle},{default:i(()=>[l(n,{type:"selection",width:"40",align:"center"}),l(n,{type:"index",label:e(t)("log.index"),width:"80"},null,8,["label"]),l(n,{prop:"jobName",label:e(t)("log.jobName"),"show-overflow-tooltip":""},null,8,["label"]),l(n,{prop:"jobMessage",label:e(t)("log.jobMessage"),"show-overflow-tooltip":""},null,8,["label"]),l(n,{prop:"jobLogStatus",label:e(t)("log.jobLogStatus"),"show-overflow-tooltip":""},{default:i(s=>[l(q,{options:e($),value:s.row.jobLogStatus},null,8,["options","value"])]),_:1},8,["label"]),l(n,{prop:"executeTime",label:e(t)("log.executeTime"),"show-overflow-tooltip":""},null,8,["label"]),l(n,{prop:"exceptionInfo",label:e(t)("log.exceptionInfo"),"show-overflow-tooltip":""},null,8,["label"]),l(n,{prop:"createTime",label:e(t)("log.createTime"),"show-overflow-tooltip":""},null,8,["label"]),l(n,{label:a.$t("common.action"),width:"150"},{default:i(s=>[m((c(),p(y,{text:"",type:"primary",onClick:K=>e(z).openDialog(s.row.jobLogId)},{default:i(()=>[w(j(a.$t("common.editBtn")),1)]),_:2},1032,["onClick"])),[[f,"pix_log_edit"]]),m((c(),p(y,{text:"",type:"primary",onClick:K=>S([s.row.jobLogId])},{default:i(()=>[w(j(a.$t("common.delBtn")),1)]),_:2},1032,["onClick"])),[[f,"sys_log_del"]])]),_:1},8,["label"])]),_:1},8,["data","cell-style","header-cell-style"])),[[G,e(u).loading]]),l(M,X({onSizeChange:e(H),onCurrentChange:e(B)},e(u).pagination),null,16,["onSizeChange","onCurrentChange"])])]),_:1},8,["modelValue"])}}});export{le as default};
