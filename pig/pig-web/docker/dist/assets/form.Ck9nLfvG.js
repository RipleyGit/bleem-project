import{v as C,d as f,r as b}from"./index.Cli_Cq8U.js";import{g as F,p as L,a as S,d as j}from"./dept.CKLv1ojX.js";import{a as E,r as p,y as G,ae as n,af as H,o as v,b as Q,G as r,H as o,Q as R,E as z,u as t,e as A,U as y,V as I,x as J,t as K}from"./vue.DKOcwzik.js";const M={class:"system-dept-dialog-container"},N={class:"dialog-footer"},P=E({name:"systemDeptDialog",emits:["refresh"],setup(W,{expose:V,emit:$}){const x=$,{t:O}=C.useI18n(),m=p(),l=G({parentId:"",deptId:"",name:"",sortOrder:9999}),c=p([]),u=p(!1),i=p(!1),_=p({parentId:[{required:!0,message:"\u4E0A\u7EA7\u90E8\u95E8\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],name:[{validator:b.overLength,trigger:"blur"},{required:!0,message:"\u90E8\u95E8\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],sortOrder:[{validator:b.overLength,trigger:"blur"},{required:!0,message:"\u6392\u5E8F\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),T=async()=>{if(!await m.value.validate().catch(()=>{}))return!1;try{i.value=!0,l.deptId?await L(l):await S(l),f().success(O(l.deptId?"common.editSuccessText":"common.addSuccessText")),u.value=!1,x("refresh")}catch(e){f().error(e.msg)}finally{i.value=!1}},w=async()=>{j().then(e=>{c.value=[];const a={id:"0",name:"\u6839\u90E8\u95E8",children:[]};a.children=e.data,c.value.push(a)})};return V({openDialog:(e,a)=>{u.value=!0,l.deptId="",K(()=>{var d;(d=m.value)==null||d.resetFields(),l.parentId=a}),e==="edit"&&F(a).then(d=>{Object.assign(l,d.data)}).catch(d=>{f().error(d.msg)}),w()}}),(e,a)=>{const d=n("el-tree-select"),g=n("el-form-item"),U=n("el-input"),k=n("el-input-number"),B=n("el-form"),h=n("el-button"),D=n("el-dialog"),q=H("loading");return v(),Q("div",M,[r(D,{title:t(l).deptId?e.$t("common.editBtn"):e.$t("common.addBtn"),modelValue:t(u),"onUpdate:modelValue":a[4]||(a[4]=s=>J(u)?u.value=s:null),width:"600"},{footer:o(()=>[A("span",N,[r(h,{onClick:a[3]||(a[3]=s=>u.value=!1)},{default:o(()=>[y(I(e.$t("common.cancelButtonText")),1)]),_:1}),r(h,{type:"primary",onClick:T,disabled:t(i)},{default:o(()=>[y(I(e.$t("common.confirmButtonText")),1)]),_:1},8,["disabled"])])]),default:o(()=>[R((v(),z(B,{ref_key:"deptDialogFormRef",ref:m,model:t(l),"label-width":"90px",rules:t(_)},{default:o(()=>[r(g,{label:e.$t("sysdept.parentId"),prop:"parentId"},{default:o(()=>[r(d,{modelValue:t(l).parentId,"onUpdate:modelValue":a[0]||(a[0]=s=>t(l).parentId=s),data:t(c),props:{value:"id",label:"name",children:"children"},class:"w100",clearable:"","check-strictly":"","render-after-expand":!1,placeholder:e.$t("sysdept.inputparentIdTip")},null,8,["modelValue","data","placeholder"])]),_:1},8,["label"]),r(g,{label:e.$t("sysdept.name"),prop:"name"},{default:o(()=>[r(U,{modelValue:t(l).name,"onUpdate:modelValue":a[1]||(a[1]=s=>t(l).name=s),placeholder:e.$t("sysdept.inputnameTip"),clearable:""},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),r(g,{label:e.$t("sysdept.sortOrder"),prop:"sortOrder"},{default:o(()=>[r(k,{modelValue:t(l).sortOrder,"onUpdate:modelValue":a[2]||(a[2]=s=>t(l).sortOrder=s),placeholder:e.$t("sysdept.inputsortOrderTip"),clearable:""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model","rules"])),[[q,t(i)]])]),_:1},8,["title","modelValue"])])}}});export{P as default};
