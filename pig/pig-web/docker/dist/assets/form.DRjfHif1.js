import{v as q,d as b,r as F}from"./index.Cli_Cq8U.js";import{d as R}from"./dept.CKLv1ojX.js";import{p as S,a as j,g as E,v as G,b as H}from"./role.chpDoZmW.js";import{a as O,r as i,y as f,ae as u,af as P,o as _,E as h,H as t,Q,u as o,G as s,e as z,U as v,V as y,x as A,t as J}from"./vue.DKOcwzik.js";const K={class:"dialog-footer"},L=O({name:"systemRoleDialog",emits:["refresh"],setup(M,{expose:x,emit:V}){const C=V,{t:D}=q.useI18n(),c=i();i();const m=i(!1),n=i(!1),l=f({roleId:"",roleName:"",roleCode:"",roleDesc:""}),I=f({deptData:[],deptProps:{children:"children",label:"name",value:"id"}}),$=i({roleName:[{required:!0,message:"\u89D2\u8272\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{min:3,max:20,message:"\u957F\u5EA6\u5728 3 \u5230 20 \u4E2A\u5B57\u7B26",trigger:"blur"},{validator:(e,a,d)=>{H(e,a,d,l.roleId!=="")},trigger:"blur"}],roleCode:[{required:!0,message:"\u89D2\u8272\u6807\u8BC6\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{min:3,max:20,message:"\u957F\u5EA6\u5728 3 \u5230 20 \u4E2A\u5B57\u7B26",trigger:"blur"},{validator:F.validatorCapital,trigger:"blur"},{validator:(e,a,d)=>{G(e,a,d,l.roleId!=="")},trigger:"blur"}],roleDesc:[{max:128,message:"\u957F\u5EA6\u5728 128 \u4E2A\u5B57\u7B26\u5185",trigger:"blur"}]}),N=async()=>{if(!await c.value.validate().catch(()=>{}))return!1;try{n.value=!0,l.roleId?await S(l):await j(l),b().success(D(l.roleId?"common.editSuccessText":"common.addSuccessText")),m.value=!1,C("refresh")}catch(e){b().error(e.msg)}finally{n.value=!1}},w=e=>{E(e).then(a=>{Object.assign(l,a.data)})},U=()=>{R().then(e=>{I.deptData=e.data})};return x({openDialog:e=>{m.value=!0,l.roleId="",J(()=>{c.value.resetFields()}),e&&(l.roleId=e,w(e)),U()}}),(e,a)=>{const d=u("el-input"),p=u("el-form-item"),k=u("el-form"),g=u("el-button"),B=u("el-dialog"),T=P("loading");return _(),h(B,{"close-on-click-modal":!1,title:o(l).roleId?e.$t("common.editBtn"):e.$t("common.addBtn"),width:"600",draggable:"",modelValue:o(m),"onUpdate:modelValue":a[4]||(a[4]=r=>A(m)?m.value=r:null)},{footer:t(()=>[z("span",K,[s(g,{onClick:a[3]||(a[3]=r=>m.value=!1)},{default:t(()=>[v(y(e.$t("common.cancelButtonText")),1)]),_:1}),s(g,{onClick:N,type:"primary",disabled:o(n)},{default:t(()=>[v(y(e.$t("common.confirmButtonText")),1)]),_:1},8,["disabled"])])]),default:t(()=>[Q((_(),h(k,{model:o(l),rules:o($),"label-width":"90px",ref_key:"dataFormRef",ref:c},{default:t(()=>[s(p,{label:e.$t("sysrole.roleName"),prop:"roleName"},{default:t(()=>[s(d,{placeholder:e.$t("sysrole.please_enter_a_role_name"),clearable:"",modelValue:o(l).roleName,"onUpdate:modelValue":a[0]||(a[0]=r=>o(l).roleName=r)},null,8,["placeholder","modelValue"])]),_:1},8,["label"]),s(p,{label:e.$t("sysrole.roleCode"),prop:"roleCode"},{default:t(()=>[s(d,{placeholder:e.$t("sysrole.please_enter_the_role_Code"),disabled:o(l).roleId!=="",clearable:"",modelValue:o(l).roleCode,"onUpdate:modelValue":a[1]||(a[1]=r=>o(l).roleCode=r)},null,8,["placeholder","disabled","modelValue"])]),_:1},8,["label"]),s(p,{label:e.$t("sysrole.roleDesc"),prop:"roleDesc"},{default:t(()=>[s(d,{placeholder:e.$t("sysrole.please_enter_the_role_description"),maxlength:"150",rows:"3",type:"textarea",modelValue:o(l).roleDesc,"onUpdate:modelValue":a[2]||(a[2]=r=>o(l).roleDesc=r)},null,8,["placeholder","modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])),[[T,o(n)]])]),_:1},8,["title","modelValue"])}}});export{L as default};
