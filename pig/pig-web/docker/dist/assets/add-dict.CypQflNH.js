import{v as N,r as V,d as x}from"./index.Cli_Cq8U.js";import{b as O,h as P,a as Q}from"./dict.DbD4nPEQ.js";import{u as R}from"./dict.BLN-_P-8.js";import{a as S,r as g,y as k,ae as i,af as A,o as y,E as T,H as d,Q as J,u as a,G as t,b as K,M as W,a8 as X,U as _,V as w,e as Y,x as Z,t as ee}from"./vue.DKOcwzik.js";const le={class:"dialog-footer"},ae=S({name:"systemDicDialog",emits:["refresh"],setup(te,{expose:U,emit:F}){const I=F,{dict_type:C}=R("dict_type"),{t:c}=N.useI18n(),f=g(),s=g(!1),m=g(!1);g({});const o=k({id:"",dictType:"",description:"",systemFlag:"0",remarks:"",columns:[]}),D=k({dictType:[{validator:V.overLength,trigger:"blur"},{required:!0,message:"\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{validator:V.validatorNameCn,trigger:"blur"},{validator:(l,r,v)=>{O(l,r,v,o.id!=="")},trigger:"blur"}],systemFlag:[{required:!0,message:"\u5B57\u5178\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],description:[{validator:V.overLength,trigger:"blur"},{required:!0,message:"\u63CF\u8FF0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],columns:[{required:!0,message:"\u5B57\u5178\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),q=async()=>{if(!await f.value.validate().catch(()=>{}))return!1;try{m.value=!0;const{data:l}=await P(o);o.columns.forEach(async r=>{r.dictId=l.id,r.dictType=o.dictType,await Q(r)}),x().success(c("common.addSuccessText")),s.value=!1,I("refresh",o.dictType)}catch(l){x().error(l.msg)}finally{m.value=!1}};let L=1;const z=()=>{o.columns.push({sortOrder:""+L++})};return U({openDialog:()=>{s.value=!0,o.id="",ee(()=>{var l;(l=f.value)==null||l.resetFields()})}}),(l,r)=>{const v=i("el-radio"),B=i("el-radio-group"),n=i("el-form-item"),p=i("el-input"),b=i("el-button"),h=i("el-table-column"),E=i("el-table"),M=i("el-col"),G=i("el-form"),j=i("el-dialog"),H=A("loading");return y(),T(j,{title:"\u65B0\u589E\u5B57\u5178",modelValue:a(s),"onUpdate:modelValue":r[4]||(r[4]=e=>Z(s)?s.value=e:null),width:"600"},{footer:d(()=>[Y("span",le,[t(b,{onClick:r[3]||(r[3]=e=>s.value=!1)},{default:d(()=>[_(w(l.$t("common.cancelButtonText")),1)]),_:1}),t(b,{onClick:q,type:"primary",disabled:a(m)},{default:d(()=>[_(w(l.$t("common.confirmButtonText")),1)]),_:1},8,["disabled"])])]),default:d(()=>[J((y(),T(G,{model:a(o),rules:a(D),"label-width":"100px",ref_key:"dicDialogFormRef",ref:f},{default:d(()=>[t(n,{label:l.$t("sysdict.systemFlag"),prop:"systemFlag"},{default:d(()=>[t(B,{modelValue:a(o).systemFlag,"onUpdate:modelValue":r[0]||(r[0]=e=>a(o).systemFlag=e)},{default:d(()=>[(y(!0),K(W,null,X(a(C),(e,u)=>(y(),T(v,{border:"",key:u,value:e.value},{default:d(()=>[_(w(e.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(n,{label:l.$t("sysdict.dictType"),prop:"dictType"},{default:d(()=>[t(p,{placeholder:l.$t("sysdict.inputDictTypeTip"),disabled:a(o).id!=="",clearable:"",modelValue:a(o).dictType,"onUpdate:modelValue":r[1]||(r[1]=e=>a(o).dictType=e)},null,8,["placeholder","disabled","modelValue"])]),_:1},8,["label"]),t(n,{label:l.$t("sysdict.description"),prop:"description"},{default:d(()=>[t(p,{placeholder:l.$t("sysdict.inputDescriptionTip"),clearable:"",modelValue:a(o).description,"onUpdate:modelValue":r[2]||(r[2]=e=>a(o).description=e)},null,8,["placeholder","modelValue"])]),_:1},8,["label"]),t(M,{span:24,class:"mb20"},{default:d(()=>[t(n,{label:a(c)("dictItem.name"),prop:"columns"},{default:d(()=>[t(E,{data:a(o).columns,border:"",style:{width:"100%"},"max-height":"500"},{default:d(()=>[t(h,{type:"index",label:a(c)("createTable.index"),width:"50"},{header:d(()=>[t(b,{icon:"Plus",size:"small",type:"primary",circle:"",onClick:z})]),default:d(e=>[t(b,{icon:"Minus",size:"small",type:"danger",circle:"",onClick:u=>{return $=e.$index,e.row,void o.columns.splice($,1);var $}},null,8,["onClick"])]),_:1},8,["label"]),t(h,{prop:"label",label:l.$t("dictItem.label"),"show-overflow-tooltip":""},{default:d(e=>[t(p,{modelValue:e.row.label,"onUpdate:modelValue":u=>e.row.label=u,placeholder:a(c)("dictItem.inputLabelTip")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:1},8,["label"]),t(h,{prop:"value",label:l.$t("dictItem.itemValue"),"show-overflow-tooltip":""},{default:d(e=>[t(p,{modelValue:e.row.value,"onUpdate:modelValue":u=>e.row.value=u,placeholder:a(c)("dictItem.inputItemValueTip")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["data"])]),_:1},8,["label"])]),_:1})]),_:1},8,["model","rules"])),[[H,a(m)]])]),_:1},8,["modelValue"])}}});export{ae as default};
