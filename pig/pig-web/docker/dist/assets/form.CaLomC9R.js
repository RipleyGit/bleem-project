import{v as F,d as T,r as f}from"./index.Cli_Cq8U.js";import{p as L,a as q,g as j,v as C}from"./fieldtype.BFTjfun7.js";import{a as R,r as n,y as S,ae as m,af as E,o as v,E as b,H as r,Q as G,u as e,G as d,e as H,U as h,V,x as I,t as O}from"./vue.DKOcwzik.js";const Q={class:"dialog-footer"},z=R({name:"systemFieldTypeDialog",emits:["refresh"],setup(A,{expose:k,emit:x}){const _=x,{t:i}=F.useI18n(),c=n(),u=n(!1),s=n(!1),l=S({id:"",columnType:"",attrType:"",packageName:"",createTime:""}),N=n({columnType:[{required:!0,message:"\u5B57\u6BB5\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{validator:f.overLength,trigger:"blur"},{validator:(t,a,p)=>{C(t,a,p,l.id!=="")}}],attrType:[{validator:f.overLength,trigger:"blur"},{required:!0,message:"\u5C5E\u6027\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],packageName:[{validator:f.overLength,trigger:"blur"}]}),w=async()=>{if(!await c.value.validate().catch(()=>{}))return!1;try{s.value=!0,l.id?await L(l):await q(l),T().success(i(l.id?"common.editSuccessText":"common.addSuccessText")),u.value=!1,_("refresh")}catch(t){T().error(t.msg)}finally{s.value=!1}},U=t=>{j(t).then(a=>{Object.assign(l,a.data)})};return k({openDialog:t=>{u.value=!0,O(()=>{var a;(a=c.value)==null||a.resetFields()}),t?(l.id=t,U(t)):l.id=""}}),(t,a)=>{const p=m("el-input"),g=m("el-form-item"),B=m("el-form"),y=m("el-button"),$=m("el-dialog"),D=E("loading");return v(),b($,{title:e(l).id?t.$t("common.editBtn"):t.$t("common.addBtn"),modelValue:e(u),"onUpdate:modelValue":a[4]||(a[4]=o=>I(u)?u.value=o:null),width:"600","close-on-click-modal":!1,draggable:""},{footer:r(()=>[H("span",Q,[d(y,{onClick:a[3]||(a[3]=o=>u.value=!1)},{default:r(()=>[h(V(t.$t("common.cancelButtonText")),1)]),_:1}),d(y,{type:"primary",onClick:w,disabled:e(s)},{default:r(()=>[h(V(t.$t("common.confirmButtonText")),1)]),_:1},8,["disabled"])])]),default:r(()=>[G((v(),b(B,{ref_key:"dataFormRef",ref:c,model:e(l),rules:e(N),formDialogRef:"","label-width":"90px"},{default:r(()=>[d(g,{label:e(i)("fieldtype.columnType"),prop:"columnType"},{default:r(()=>[d(p,{modelValue:e(l).columnType,"onUpdate:modelValue":a[0]||(a[0]=o=>e(l).columnType=o),placeholder:e(i)("fieldtype.inputcolumnTypeTip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),d(g,{label:e(i)("fieldtype.attrType"),prop:"attrType"},{default:r(()=>[d(p,{modelValue:e(l).attrType,"onUpdate:modelValue":a[1]||(a[1]=o=>e(l).attrType=o),placeholder:e(i)("fieldtype.inputattrTypeTip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),d(g,{label:e(i)("fieldtype.packageName"),prop:"packageName"},{default:r(()=>[d(p,{modelValue:e(l).packageName,"onUpdate:modelValue":a[2]||(a[2]=o=>e(l).packageName=o),placeholder:e(i)("fieldtype.inputpackageNameTip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model","rules"])),[[D,e(s)]])]),_:1},8,["title","modelValue"])}}});export{z as default};
