import{v as Q,d as U,r as f}from"./index.Cli_Cq8U.js";import{p as A,a as J,g as K}from"./datasource.B_YGW1MI.js";import{u as P}from"./dict.BLN-_P-8.js";import{a as W,r as _,y as X,ae as u,af as Y,o as n,E as m,H as r,Q as Z,u as e,G as s,b as k,M as q,a8 as x,U as T,V,S as b,e as ee,x as ae,t as le}from"./vue.DKOcwzik.js";import"./dict.DbD4nPEQ.js";const oe={class:"dialog-footer"},re=W({name:"systemDatasourceConfDialog",emits:["refresh"],setup(se,{expose:L,emit:N}){const B=N,{t}=Q.useI18n(),v=_(),g=_(!1),y=_(!1),{ds_config_type:D,ds_type:$}=P("ds_config_type","ds_type"),a=X({id:"",name:"",url:"",username:"",password:void 0,createTime:"",updateTime:"",dsType:"mysql",confType:0,dsName:"",instance:"",port:3306,host:""}),j=_({name:[{required:!0,message:"\u522B\u540D\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{validator:f.overLength,trigger:"blur"},{validator:(d,l,h)=>{l&&!/(?=.*[a-z])(?=.*_)/.test(l)?h(new Error("\u6570\u636E\u6E90\u540D\u79F0\u4E0D\u5408\u6CD5, \u7EC4\u540D_\u6570\u636E\u6E90\u540D\u5F62\u5F0F")):h()},trigger:"blur"}],url:[{required:!0,message:"jdbcurl\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{min:10,max:500,message:"URL\u957F\u5EA6\u5FC5\u987B\u4ECB\u4E8E 10 \u548C 500 \u5B57\u7B26\u4E4B\u95F4",trigger:"blur"}],username:[{validator:f.overLength,trigger:"blur"},{required:!0,message:"\u7528\u6237\u540D\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],password:[{validator:f.overLength,trigger:"blur"},{required:!0,message:"\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],dsType:[{required:!0,message:"\u6570\u636E\u5E93\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],confType:[{required:!0,message:"\u914D\u7F6E\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],dsName:[{validator:f.overLength,trigger:"blur"},{required:!0,message:"\u6570\u636E\u5E93\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],instance:[{validator:f.overLength,trigger:"blur"},{required:!0,message:"\u5B9E\u4F8B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],port:[{validator:f.overLength,trigger:"blur"},{required:!0,message:"\u7AEF\u53E3\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],host:[{validator:f.overLength,trigger:"blur"},{required:!0,message:"\u4E3B\u673A\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),C=async()=>{var d;if(!await v.value.validate().catch(()=>{}))return!1;a.password=(d=a.password)!=null&&d.includes("******")?void 0:a.password;try{y.value=!0,a.id?await A(a):await J(a),U().success(t(a.id?"common.editSuccessText":"common.addSuccessText")),g.value=!1,B("refresh")}catch(l){U().error(l.msg)}finally{y.value=!1}},R=d=>K(d).then(l=>{Object.assign(a,l.data)});return L({openDialog:async d=>{g.value=!0,a.id="",le(()=>{var l;(l=v.value)==null||l.resetFields()}),d&&(a.id=d,await R(d),a.password="********")}}),(d,l)=>{const h=u("el-option"),S=u("el-select"),p=u("el-form-item"),c=u("el-col"),i=u("el-input"),E=u("el-radio"),F=u("el-radio-group"),G=u("el-input-number"),z=u("el-row"),H=u("el-form"),w=u("el-button"),I=u("el-dialog"),M=Y("loading");return n(),m(I,{title:e(a).id?d.$t("common.editBtn"):d.$t("common.addBtn"),modelValue:e(g),"onUpdate:modelValue":l[11]||(l[11]=o=>ae(g)?g.value=o:null),"close-on-click-modal":!1,draggable:""},{footer:r(()=>[ee("span",oe,[s(w,{onClick:l[10]||(l[10]=o=>g.value=!1)},{default:r(()=>[T(V(d.$t("common.cancelButtonText")),1)]),_:1}),s(w,{type:"primary",onClick:C,disabled:e(y)},{default:r(()=>[T(V(d.$t("common.confirmButtonText")),1)]),_:1},8,["disabled"])])]),default:r(()=>[Z((n(),m(H,{ref_key:"dataFormRef",ref:v,model:e(a),rules:e(j),formDialogRef:"","label-width":"90px"},{default:r(()=>[s(z,{gutter:20},{default:r(()=>[s(c,{span:12,class:"mb20"},{default:r(()=>[s(p,{label:e(t)("datasourceconf.dsType"),prop:"dsType"},{default:r(()=>[s(S,{modelValue:e(a).dsType,"onUpdate:modelValue":l[0]||(l[0]=o=>e(a).dsType=o),placeholder:e(t)("datasourceconf.inputdsTypeTip")},{default:r(()=>[(n(!0),k(q,null,x(e($),o=>(n(),m(h,{key:o.value,label:o.label,value:o.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),s(c,{span:12,class:"mb20"},{default:r(()=>[s(p,{label:e(t)("datasourceconf.name"),prop:"name"},{default:r(()=>[s(i,{modelValue:e(a).name,"onUpdate:modelValue":l[1]||(l[1]=o=>e(a).name=o),placeholder:e(t)("datasourceconf.inputnameTip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),s(c,{span:12,class:"mb20"},{default:r(()=>[s(p,{label:e(t)("datasourceconf.username"),prop:"username"},{default:r(()=>[s(i,{modelValue:e(a).username,"onUpdate:modelValue":l[2]||(l[2]=o=>e(a).username=o),placeholder:e(t)("datasourceconf.inputusernameTip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),s(c,{span:12,class:"mb20"},{default:r(()=>[s(p,{label:e(t)("datasourceconf.password"),prop:"password"},{default:r(()=>[s(i,{modelValue:e(a).password,"onUpdate:modelValue":l[3]||(l[3]=o=>e(a).password=o),placeholder:e(t)("datasourceconf.inputpasswordTip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),s(c,{span:12,class:"mb20"},{default:r(()=>[s(p,{label:e(t)("datasourceconf.confType"),prop:"confType"},{default:r(()=>[s(F,{modelValue:e(a).confType,"onUpdate:modelValue":l[4]||(l[4]=o=>e(a).confType=o)},{default:r(()=>[(n(!0),k(q,null,x(e(D),(o,O)=>(n(),m(E,{value:Number(o.value),border:"",key:O},{default:r(()=>[T(V(o.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(a).confType===0&&e(a).dsType==="mssql"?(n(),m(c,{key:0,span:12,class:"mb20"},{default:r(()=>[s(p,{label:e(t)("datasourceconf.instance"),prop:"instance"},{default:r(()=>[s(i,{modelValue:e(a).instance,"onUpdate:modelValue":l[5]||(l[5]=o=>e(a).instance=o),placeholder:e(t)("datasourceconf.inputinstanceTip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})):b("",!0),e(a).confType===0?(n(),m(c,{key:1,span:12,class:"mb20"},{default:r(()=>[s(p,{label:e(t)("datasourceconf.port"),prop:"port"},{default:r(()=>[s(G,{modelValue:e(a).port,"onUpdate:modelValue":l[6]||(l[6]=o=>e(a).port=o),placeholder:e(t)("datasourceconf.inputportTip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})):b("",!0),e(a).confType===0?(n(),m(c,{key:2,span:12,class:"mb20"},{default:r(()=>[s(p,{label:e(t)("datasourceconf.host"),prop:"host"},{default:r(()=>[s(i,{modelValue:e(a).host,"onUpdate:modelValue":l[7]||(l[7]=o=>e(a).host=o),placeholder:e(t)("datasourceconf.inputhostTip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})):b("",!0),e(a).confType===0?(n(),m(c,{key:3,span:12,class:"mb20"},{default:r(()=>[s(p,{label:e(t)("datasourceconf.dsName"),prop:"dsName"},{default:r(()=>[s(i,{modelValue:e(a).dsName,"onUpdate:modelValue":l[8]||(l[8]=o=>e(a).dsName=o),placeholder:e(t)("datasourceconf.inputdsNameTip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})):b("",!0),e(a).confType===1?(n(),m(c,{key:4,span:24,class:"mb20"},{default:r(()=>[s(p,{label:e(t)("datasourceconf.url"),prop:"url"},{default:r(()=>[s(i,{modelValue:e(a).url,"onUpdate:modelValue":l[9]||(l[9]=o=>e(a).url=o),type:"textarea",placeholder:e(t)("datasourceconf.inputurlTip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})):b("",!0)]),_:1})]),_:1},8,["model","rules"])),[[M,e(y)]])]),_:1},8,["title","modelValue"])}}});export{re as default};
