import{f as S,e as _}from"./role.chpDoZmW.js";import{v as T,p as V,o as j,d as H}from"./index.Cli_Cq8U.js";import{a as P,r as n,y as U,ae as r,af as A,o as E,b as G,G as t,H as i,Q as M,u as l,e as u,U as p,V as k}from"./vue.DKOcwzik.js";const N={class:"system-role-dialog-container"},Q={class:"flex items-center justify-between"},q={class:"flex mr-16"},z={class:"dialog-footer"},B=P({name:"role-permession",setup(F,{expose:y}){const{t:v}=T.useI18n(),d=n(),D=n(!0),c=n(!1),e=U({checkedKeys:[],treeData:[],defaultProps:{label:"name",value:"id"},roleId:"",dialog:{isShowDialog:!1,title:"\u5206\u914D\u6743\u9650",submitTxt:"\u66F4\u65B0"}}),h=n([]),b=o=>{const a=e.treeData;for(let s=0;s<a.length;s++)d.value.store.nodesMap[a[s].id].expanded=o},x=o=>{var a,s;o?(a=d.value)==null||a.setCheckedKeys(e.treeData.map(g=>g.id)):(s=d.value)==null||s.setCheckedKeys([])},w=()=>{const o=d.value.getCheckedKeys().join(",").concat(",").concat(d.value.getHalfCheckedKeys().join(","));c.value=!0,_(e.roleId,o).then(()=>{e.dialog.isShowDialog=!1,H().success(v("common.editSuccessText"))}).finally(()=>{c.value=!1})};return y({openDialog:o=>{e.checkedKeys=[],e.treeData=[],h.value=[],e.roleId=o.roleId,c.value=!0,S(o.roleId).then(a=>(h.value=a.data,V())).then(a=>{e.treeData=a.data,e.checkedKeys=j.resolveAllEunuchNodeId(e.treeData,h.value,[])}).finally(()=>{c.value=!1}),e.dialog.isShowDialog=!0}}),(o,a)=>{const s=r("el-checkbox"),g=r("el-tree"),C=r("el-scrollbar"),f=r("el-button"),K=r("el-dialog"),I=A("loading");return E(),G("div",N,[t(K,{width:"30%",modelValue:l(e).dialog.isShowDialog,"onUpdate:modelValue":a[1]||(a[1]=m=>l(e).dialog.isShowDialog=m),"close-on-click-modal":!1,draggable:""},{header:i(()=>[u("div",Q,[u("div",null,k(l(e).dialog.title),1),u("div",q,[t(s,{label:"\u5C55\u5F00/\u6298\u53E0",onChange:b}),t(s,{label:"\u5168\u9009/\u4E0D\u5168\u9009",onChange:x})])])]),footer:i(()=>[u("span",z,[t(f,{onClick:a[0]||(a[0]=m=>l(e).dialog.isShowDialog=!1)},{default:i(()=>a[2]||(a[2]=[p("\u53D6 \u6D88")])),_:1}),t(f,{type:"primary",onClick:w},{default:i(()=>[p(k(l(e).dialog.submitTxt),1)]),_:1})])]),default:i(()=>[t(C,{class:"h-[400px] sm:h-[600px]"},{default:i(()=>[M(t(g,{ref_key:"menuTree",ref:d,data:l(e).treeData,"default-checked-keys":l(e).checkedKeys,"check-strictly":!l(D),props:l(e).defaultProps,class:"filter-tree","node-key":"id","highlight-current":"","show-checkbox":""},null,8,["data","default-checked-keys","check-strictly","props"]),[[I,l(c)]])]),_:1})]),_:1},8,["modelValue"])])}}});export{B as default};
