import{a as P,r as h,y as p,ae as s,af as S,o as f,E as b,H as l,G as a,u as o,e as V,Q as w,U as j,V as I,ap as z}from"./vue.DKOcwzik.js";import{v as B,r as v,D,d as K,a as E}from"./index.BLQPjP0P.js";const G=P({name:"loginMobile",emits:["signInSuccess"],setup(H,{emit:$}){const{t:r}=B.useI18n(),k=$,m=h(),c=h(!1),i=p({mobile:"",code:""}),U=p({mobile:[{validator:v.overLength,trigger:"blur"},{required:!0,trigger:"blur",validator:v.validatePhone}],code:[{validator:v.overLength,trigger:"blur"},{required:!0,trigger:"blur",message:r("mobile.codeText")}]}),q=async()=>{if(!await m.value.validateField("mobile").catch(()=>{}))return;const t=await D(i.mobile);t.data?(K().success("\u9A8C\u8BC1\u7801\u53D1\u9001\u6210\u529F"),C()):K().error(t.msg)},_=async()=>{if(await m.value.validate().catch(()=>{}))try{c.value=!0,await E().loginByMobile(i),k("signInSuccess")}finally{c.value=!1}},e=p({msgText:r("mobile.codeText"),msgTime:60,msgKey:!1}),C=()=>{e.msgText=`${e.msgTime}\u79D2\u540E\u91CD\u53D1`,e.msgKey=!0;const t=setInterval(()=>{e.msgTime--,e.msgText=`${e.msgTime}\u79D2\u540E\u91CD\u53D1`,e.msgTime===0&&(e.msgTime=60,e.msgText=r("mobile.codeText"),e.msgKey=!1,clearInterval(t))},1e3)};return(t,n)=>{const x=s("el-input"),d=s("el-form-item"),F=s("ele-Position"),L=s("el-icon"),u=s("el-col"),T=s("el-button"),M=s("el-form"),y=S("waves");return f(),b(M,{size:"large",class:"login-content-form",ref_key:"loginFormRef",ref:m,rules:o(U),model:o(i),onKeyup:z(_,["enter"])},{default:l(()=>[a(d,{class:"login-animation1",prop:"mobile"},{default:l(()=>[a(x,{text:"",placeholder:t.$t("mobile.placeholder1"),modelValue:o(i).mobile,"onUpdate:modelValue":n[0]||(n[0]=g=>o(i).mobile=g),clearable:"",autocomplete:"off"},{prefix:l(()=>n[2]||(n[2]=[V("i",{class:"iconfont icon-dianhua el-input__icon"},null,-1)])),_:1},8,["placeholder","modelValue"])]),_:1}),a(d,{class:"login-animation2",prop:"code"},{default:l(()=>[a(u,{span:15},{default:l(()=>[a(x,{text:"",maxlength:"6",placeholder:t.$t("mobile.placeholder2"),modelValue:o(i).code,"onUpdate:modelValue":n[1]||(n[1]=g=>o(i).code=g),clearable:"",autocomplete:"off"},{prefix:l(()=>[a(L,{class:"el-input__icon"},{default:l(()=>[a(F)]),_:1})]),_:1},8,["placeholder","modelValue"])]),_:1}),a(u,{span:1}),a(u,{span:8},{default:l(()=>[w((f(),b(T,{class:"login-content-code",onClick:q,loading:o(e).msgKey},{default:l(()=>[j(I(o(e).msgText),1)]),_:1},8,["loading"])),[[y]])]),_:1})]),_:1}),a(d,{class:"login-animation3"},{default:l(()=>[w((f(),b(T,{type:"primary",class:"login-content-submit",onClick:_,loading:o(c)},{default:l(()=>[V("span",null,I(t.$t("mobile.btnText")),1)]),_:1},8,["loading"])),[[y]])]),_:1})]),_:1},8,["rules","model"])}}});export{G as default};
