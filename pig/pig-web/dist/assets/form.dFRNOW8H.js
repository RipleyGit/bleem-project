import{v as q,d as V,r as C}from"./index.BLQPjP0P.js";import{p as E,a as F,g as R}from"./group.D1FFaLZK.js";import{l as j}from"./template.DK_MCY6U.js";import{a as S,r as m,y as H,ae as d,af as M,o as c,E as b,H as r,Q as O,u as a,G as u,b as Q,M as z,a8 as A,e as J,U as y,V as x,x as K,t as P}from"./vue.DKOcwzik.js";const W={class:"dialog-footer"},X=S({name:"GenGroupDialog",emits:["refresh"],setup(Y,{expose:D,emit:_}){const I=_,{t:p}=q.useI18n(),g=m(),s=m(!1),i=m(!1),h=m([]),e=H({id:"",groupName:"",groupDesc:"",templateId:[],putList:[]}),N=m({groupName:[{validator:C.overLength,trigger:"blur"},{required:!0,message:"\u5206\u7EC4\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],templateId:[{required:!0,message:"\u6A21\u677F\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),T=async()=>{if(!await g.value.validate().catch(()=>{}))return!1;try{i.value=!0,e.id?await E(e):await F(e),V().success(p(e.id?"common.editSuccessText":"common.addSuccessText")),s.value=!1,I("refresh")}catch(l){V().error(l.msg)}finally{i.value=!1}},w=l=>{R(l).then(t=>{Object.assign(e,t.data),e.templateId=[],t.data.templateList&&t.data.templateList.forEach(n=>{e.templateId.push(n.id)})})},G=()=>{j().then(l=>{h.value=l.data})};return D({openDialog:l=>{s.value=!0,e.id="",P(()=>{g.value.resetFields()}),l&&(e.id=l,w(l)),G()}}),(l,t)=>{const n=d("el-input"),f=d("el-form-item"),U=d("el-option"),$=d("el-select"),k=d("el-form"),v=d("el-button"),B=d("el-dialog"),L=M("loading");return c(),b(B,{modelValue:a(s),"onUpdate:modelValue":t[4]||(t[4]=o=>K(s)?s.value=o:null),title:a(e).id?l.$t("common.editBtn"):l.$t("common.addBtn"),width:"600"},{footer:r(()=>[J("span",W,[u(v,{onClick:t[3]||(t[3]=o=>s.value=!1)},{default:r(()=>[y(x(l.$t("common.cancelButtonText")),1)]),_:1}),u(v,{type:"primary",onClick:T,disabled:a(i)},{default:r(()=>[y(x(l.$t("common.confirmButtonText")),1)]),_:1},8,["disabled"])])]),default:r(()=>[O((c(),b(k,{ref_key:"dataFormRef",ref:g,model:a(e),rules:a(N),formDialogRef:"","label-width":"90px"},{default:r(()=>[u(f,{label:a(p)("group.groupName"),prop:"groupName"},{default:r(()=>[u(n,{modelValue:a(e).groupName,"onUpdate:modelValue":t[0]||(t[0]=o=>a(e).groupName=o),placeholder:a(p)("group.inputGroupNameTip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),u(f,{label:l.$t("group.templateType"),prop:"templateId"},{default:r(()=>[u($,{modelValue:a(e).templateId,"onUpdate:modelValue":t[1]||(t[1]=o=>a(e).templateId=o),placeholder:l.$t("group.selectType"),clearable:"",multiple:""},{default:r(()=>[(c(!0),Q(z,null,A(a(h),o=>(c(),b(U,{key:o.id,label:o.templateName,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),u(f,{label:a(p)("group.groupDesc"),prop:"groupDesc"},{default:r(()=>[u(n,{type:"textarea",maxlength:"100",rows:5,modelValue:a(e).groupDesc,"onUpdate:modelValue":t[2]||(t[2]=o=>a(e).groupDesc=o),placeholder:a(p)("group.inputGroupDescTip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model","rules"])),[[L,a(i)]])]),_:1},8,["modelValue","title"])}}});export{X as default};
