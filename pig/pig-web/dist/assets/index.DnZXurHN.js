import{a as G,aF as M,r as v,y as O,q as W,ae as r,af as A,o as y,b as F,e as _,Q as k,W as J,u as e,G as l,H as t,ap as P,M as X,a8 as Y,E as S,U as h,V as f,x as Z,K as ee}from"./vue.DKOcwzik.js";import{u as le}from"./table.byngke96.js";import{j as ae,g as te,k as oe}from"./table.DbVok9xg.js";import{l as ne}from"./datasource.D8ynhPg0.js";import{v as re,B as se,d as me}from"./index.BLQPjP0P.js";const ue={class:"layout-padding"},de={class:"layout-padding-auto layout-padding-view"},ie={class:"mb8",style:{width:"100%"}},pe=G({name:"systemTable",setup(ce){const V=M(),{t:u}=re.useI18n(),w=v(),i=v(!0),p=v(),a=O({queryForm:{dsName:"master"},pageList:ae,createdIsNeed:!1}),{getDataList:s,currentChangeHandle:T,sizeChangeHandle:$,downBlobFile:B,tableStyle:C}=le(a);W(()=>{ne().then(n=>{p.value=n.data,p.value.length>0&&(a.queryForm.dsName=p.value[0].name),s()})});const N=n=>{oe(a.queryForm.dsName,n.name).then(()=>{me().success(u("common.optSuccessText"))})},L=()=>{w.value.resetFields(),s()},U=()=>{B("/gen/table/export",a.queryForm,"table.xlsx")};return(n,m)=>{const q=r("el-option"),z=r("el-select"),g=r("el-form-item"),E=r("el-input"),c=r("el-button"),H=r("el-form"),x=r("el-row"),I=r("right-toolbar"),d=r("el-table-column"),K=r("el-table"),Q=r("pagination"),R=A("loading");return y(),F("div",ue,[_("div",de,[k(l(x,{class:"ml10"},{default:t(()=>[l(H,{inline:!0,model:e(a).queryForm,onKeyup:P(e(s),["enter"]),ref_key:"queryRef",ref:w},{default:t(()=>[l(g,{label:"\u6570\u636E\u6E90",prop:"name"},{default:t(()=>[l(z,{onChange:e(s),placeholder:"\u8BF7\u9009\u62E9\u6570\u636E\u6E90",modelValue:e(a).queryForm.dsName,"onUpdate:modelValue":m[0]||(m[0]=o=>e(a).queryForm.dsName=o)},{default:t(()=>[l(q,{label:"\u9ED8\u8BA4\u6570\u636E\u6E90",value:"master"}),(y(!0),F(X,null,Y(e(p),o=>(y(),S(q,{key:o.id,label:o.name,value:o.name},null,8,["label","value"]))),128))]),_:1},8,["onChange","modelValue"])]),_:1}),l(g,{label:n.$t("table.tableName"),prop:"tableName"},{default:t(()=>[l(E,{placeholder:n.$t("table.inputtableNameTip"),modelValue:e(a).queryForm.tableName,"onUpdate:modelValue":m[1]||(m[1]=o=>e(a).queryForm.tableName=o)},null,8,["placeholder","modelValue"])]),_:1},8,["label"]),l(g,null,{default:t(()=>[l(c,{onClick:e(s),icon:"search",type:"primary"},{default:t(()=>[h(f(n.$t("common.queryBtn")),1)]),_:1},8,["onClick"]),l(c,{onClick:L,icon:"Refresh"},{default:t(()=>[h(f(n.$t("common.resetBtn")),1)]),_:1})]),_:1})]),_:1},8,["model","onKeyup"])]),_:1},512),[[J,e(i)]]),l(x,null,{default:t(()=>[_("div",ie,[l(I,{export:!0,onExportExcel:U,onQueryTable:e(s),class:"ml10",style:{float:"right","margin-right":"20px"},showSearch:e(i),"onUpdate:showSearch":m[2]||(m[2]=o=>Z(i)?i.value=o:null)},null,8,["onQueryTable","showSearch"])])]),_:1}),k((y(),S(K,{data:e(a).dataList,style:{width:"100%"},border:"","cell-style":e(C).cellStyle,"header-cell-style":e(C).headerCellStyle},{default:t(()=>[l(d,{label:e(u)("table.index"),type:"index",width:"60"},null,8,["label"]),l(d,{label:e(u)("table.tableName"),prop:"name","show-overflow-tooltip":""},null,8,["label"]),l(d,{label:e(u)("table.tableDesc"),prop:"comment","show-overflow-tooltip":""},null,8,["label"]),l(d,{label:e(u)("table.createTime"),prop:"createTime","show-overflow-tooltip":""},null,8,["label"]),l(d,{label:n.$t("common.action"),width:"250"},{default:t(o=>[l(c,{icon:"Refresh",onClick:D=>N(o.row),text:"",type:"primary"},{default:t(()=>[h(f(n.$t("gen.syncBtn")),1)]),_:2},1032,["onClick"]),l(c,{icon:"FolderOpened",onClick:D=>{return b=o.row,void te(a.queryForm.dsName,b.name).then(j=>{se(j.data.fieldList)&&N(b)}).finally(()=>{V.push({path:"/gen/gener/index",query:{tableName:b.name,dsName:a.queryForm.dsName}})});var b},text:"",type:"primary"},{default:t(()=>[h(f(n.$t("gen.genBtn")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data","cell-style","header-cell-style"])),[[R,e(a).loading]]),l(Q,ee({onCurrentChange:e(T),onSizeChange:e($)},e(a).pagination),null,16,["onCurrentChange","onSizeChange"])])])}}});export{pe as default};
